<div class="reset-page">
  <button type="button" class="close-btn" aria-label="Закрыть" title="Закрыть" (click)="goHome()">
    ×
  </button>

  @if (success) {
    <div class="reset-box">
      <h2>Сброс пароля</h2>
      <p>Ваш запрос на сброс пароля получен.</p>
      <p>
        Если для <b>{{ emailCtrl.value }}</b> существует учётная запись, вы получите письмо со
        ссылкой для сброса пароля. Если письмо не пришло — проверьте «Спам».
      </p>
      <button type="button" class="btn" (click)="goToLogin()">Назад к входу</button>
    </div>
  } @else {
    <div class="reset-box">
      <h2>Сброс пароля</h2>
      <p>
        Пожалуйста, введите адрес электронной почты, связанный с вашей учётной записью.<br />
        На него будет отправлено письмо с дальнейшими инструкциями по сбросу пароля.
      </p>

      <form [formGroup]="form" (ngSubmit)="sendEmail()">
        <div class="input-area">
          <input
            pInputText
            type="email"
            autocomplete="email"
            formControlName="email"
            placeholder="you@email.com"
            [class.invalid]="isEmailTouched() && (hasEmailRequired() || hasEmailFormatError())"
            aria-describedby="email-error"
            required
          />
          @if (isEmailTouched() && hasEmailRequired()) {
            <div id="email-error" class="error-text">Укажите email</div>
          } @else if (isEmailTouched() && hasEmailFormatError()) {
            <div id="email-error" class="error-text">Введён некорректный email</div>
          }
        </div>

        <button type="submit" class="btn" [disabled]="isLoading || form.invalid">
          {{ isLoading ? 'Отправка…' : 'Отправить письмо' }}
        </button>
      </form>
    </div>
  }
</div>
