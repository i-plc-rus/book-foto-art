<div class="register-page">
  <div class="register-left">
    <header class="register-header">
      <img src="assets/icons/logo.svg" alt="Логотип" class="logo" />
      <button class="close-btn" routerLink="/">&times;</button>
    </header>

    <main class="register-content">
      <h1 class="register-title">Создайте аккаунт бесплатно</h1>
      <p class="register-subtitle">
        Уже есть аккаунт?
        <a routerLink="/login">Войти</a>
      </p>

      <button class="social-btn yandex">
        <img src="assets/icons/yandex-start-svgrepo-com.svg" alt="Яндекс" class="yandex-logo" />
        Войти с Яндекс ID
      </button>

      <div class="register-or">
        <div class="line"></div>
        <div>или с помощью email</div>
        <div class="line"></div>
      </div>

      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <!-- Шаг 1 -->
        @switch (step) {
          @case (1) {
            <div class="input-area">
              <input
                type="email"
                placeholder="Email"
                formControlName="email"
                required
                [class.invalid]="isEmailTouched() && (hasEmailRequired() || hasEmailFormatError())"
              />
              @if (isEmailTouched() && hasEmailRequired()) {
                <div class="error-text">Укажите email</div>
              } @else if (isEmailTouched() && hasEmailFormatError()) {
                <div class="error-text">Введён некорректный email</div>
              }
            </div>

            <button
              type="button"
              class="submit-btn"
              (click)="nextStep()"
              [disabled]="!canContinueStep1()"
            >
              Продолжить с email
            </button>
          }
          @case (2) {
            <div class="input-area">
              <input type="email" [value]="form.get('email')?.value" disabled />
            </div>
            <div class="input-area">
              <input
                type="username"
                placeholder="Username"
                formControlName="username"
                required
                [class.invalid]="isUsernameTouched() && hasUsernameRequired()"
              />
              @if (isUsernameTouched() && hasUsernameRequired()) {
                <div class="error-text">Укажите логин</div>
              }
            </div>
            <div class="input-area">
              <input
                type="password"
                placeholder="Пароль"
                formControlName="password"
                required
                [class.invalid]="
                  isPasswordTouched() && (hasPasswordRequired() || hasPasswordLengthErr())
                "
              />
              @if (isPasswordTouched() && hasPasswordRequired()) {
                <div class="error-text">Укажите пароль</div>
              } @else if (isPasswordTouched() && hasPasswordLengthErr()) {
                <div class="error-text">Минимум 6 символов</div>
              }
            </div>

            <button [disabled]="isSubmitting || form.invalid" type="submit" class="submit-btn">
              Создать аккаунт
            </button>
          }
        }
      </form>

      <p class="register-disclaimer">
        Создавая аккаунт, вы соглашаетесь с <a href="#">условиями bookfoto.art</a> и подтверждаете,
        что прочитали и поняли их.
      </p>
    </main>
  </div>

  <div class="register-right">
    <img src="assets/icons/reg-photo.jpg" alt="Превью" />
  </div>
</div>
