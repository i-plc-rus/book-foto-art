<div class="fixed inset-0 bg-[#0000002e] bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-8 w-[100vw] h-[100vh] overflow-y-auto">
    <div class="flex items-center justify-between mb-6">
      <button (click)="close.emit()" class="text-gray-500 hover:text-gray-700">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
      <h3 class="text-xl font-semibold flex-1 text-center">Выберите фото на обложку</h3>
      <div class="flex gap-2">
        <button
          (click)="uploadPhoto.emit()"
          class="py-2 px-4 gap-1 cursor-pointer flex items-center"
        >
          <svg
            class="w-3 svg-inline--fa fa-arrow-up-from-line tw-relative tw-text-[0.7em]"
            aria-hidden="true"
            focusable="false"
            data-prefix="far"
            data-icon="arrow-up-from-line"
            role="img"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 384 512"
            as="span"
            hasHover="false"
          >
            <path
              class=""
              fill="currentColor"
              d="M209.5 39.6C204.9 34.7 198.6 32 192 32s-12.9 2.7-17.5 7.6l-128 136c-9.1 9.7-8.6 24.8 1 33.9s24.8 8.6 33.9-1L168 116.5l0 83.5 0 128c0 13.3 10.7 24 24 24s24-10.7 24-24l0-128 0-83.5 86.5 91.9c9.1 9.7 24.3 10.1 33.9 1s10.1-24.3 1-33.9l-128-136zM24 432c-13.3 0-24 10.7-24 24s10.7 24 24 24l336 0c13.3 0 24-10.7 24-24s-10.7-24-24-24L24 432z"
            ></path>
          </svg>
          Загрузить фото
        </button>
        <button
          (click)="selectPhoto.emit()"
          [disabled]="!selectedPhotoId"
          [class.opacity-50]="!selectedPhotoId"
          [class.cursor-not-allowed]="!selectedPhotoId"
          class="bg-[#1abc9c] hover:bg-[#16a085] text-white py-2 px-4"
        >
          Выбрать
        </button>
      </div>
    </div>

    @if (isLoading) {
      <div class="text-center py-8">
        <p class="text-gray-500">Загрузка фотографий...</p>
      </div>
    }

    @if (!isLoading && (!collectionPhotos || collectionPhotos.length === 0)) {
      <div class="text-center py-8">
        <p class="text-gray-500">В вашей коллекции нет фото</p>
      </div>
    }

    @if (!isLoading && collectionPhotos.length > 0) {
      <div
        class="file-grid gap-4"
        [class.grid-small]="gridSize === 'small'"
        [class.grid-large]="gridSize === 'large'"
      >
        @for (photo of collectionPhotos; track photo.id) {
          <div
            (click)="selectPhotoId(photo.id)"
            [class.border-2]="selectedPhotoId === photo.id"
            [style.borderColor]="selectedPhotoId === photo.id ? '#00c951' : 'transparent'"
            class="border border-gray-200 rounded-lg cursor-pointer overflow-hidden transition-transform hover:scale-105"
          >
            <img [src]="photo.url" alt="Collection photo" class="w-full h-full object-cover" />
          </div>
        }
      </div>
    }
  </div>
</div>
